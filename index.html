<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>QA App Debug Mode</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body class="bg-slate-900 text-white p-5">

    <div class="max-w-2xl mx-auto">
        <h1 class="text-2xl font-bold mb-4">System Connection Monitor</h1>
        
        <div id="status-box" class="p-6 rounded-lg bg-blue-600 mb-6 transition-all">
            <p id="status-text" class="text-xl font-mono text-center">INITIALIZING CONNECTION...</p>
        </div>

        <div class="bg-black p-4 rounded border border-gray-700 font-mono text-xs mb-6 h-32 overflow-y-auto">
            <p class="text-gray-500">-- Debug Console --</p>
            <div id="debug-log"></div>
        </div>

        <div id="app-content" class="hidden">
            <div class="bg-white text-black p-4 rounded shadow-lg">
                <h2 class="font-bold border-b mb-4 pb-2 text-gray-500">System List</h2>
                <div id="list-items" class="space-y-2">
                    </div>
            </div>
        </div>
    </div>

    <script>
        // 1. YOUR CONNECTION INFO
        const SB_URL = 'https://bbgcsddwzcrxwzczrojf.supabase.co'; // Ensure it has https://
        const SB_KEY = 'sb_publishable_678Ol2HCLnEtOJNwly0vDg_XQS9f72f';

        function log(msg, isError = false) {
            const div = document.getElementById('debug-log');
            const p = document.createElement('p');
            p.innerText = `> ${msg}`;
            if(isError) p.className = "text-red-500";
            div.appendChild(p);
            console.log(msg);
        }

        async function start() {
            log("Attempting to connect to: " + SB_URL);
            
            if (SB_URL.includes("YOUR_SUPABASE")) {
                log("ERROR: You haven't replaced the placeholder keys!", true);
                document.getElementById('status-text').innerText = "❌ KEYS MISSING";
                return;
            }

            try {
                const supabase = window.supabase.createClient(SB_URL, SB_KEY);
                log("Supabase Client created.");

                log("Fetching data from table 'systems'...");
                const { data, error } = await supabase.from('systems').select('*');

                if (error) {
                    log("DATABASE ERROR: " + error.message, true);
                    document.getElementById('status-box').className = "p-6 rounded-lg bg-red-600";
                    document.getElementById('status-text').innerText = "❌ CONNECTION FAILED";
                    return;
                }

                if (data) {
                    log("SUCCESS! Found " + data.length + " systems.");
                    document.getElementById('status-box').className = "p-6 rounded-lg bg-green-600";
                    document.getElementById('status-text').innerText = "✅ SYSTEMS LOADED";
                    document.getElementById('app-content').classList.remove('hidden');

                    const list = document.getElementById('list-items');
                    data.forEach(s => {
                        const item = document.createElement('div');
                        item.className = "flex justify-between p-2 bg-gray-100 rounded border";
                        item.innerHTML = `<strong>System #${s.id}</strong> <span>${s.notes || 'No notes'}</span>`;
                        list.appendChild(item);
                    });
                }

            } catch (err) {
                log("CRITICAL SCRIPT ERROR: " + err.message, true);
                document.getElementById('status-box').className = "p-6 rounded-lg bg-red-600 text-white";
                document.getElementById('status-text').innerText = "❌ CRASHED";
            }
        }

        // Wait a second for the library to settle
        setTimeout(start, 1000);
    </script>
</body>
</html>
