<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Universal QA App</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body class="bg-slate-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- CONFIG ---
        const SB_URL = 'https://bbgcsddwzcrxwzczrojf.supabase.co';
        const SB_KEY = 'sb_publishable_678Ol2HCLnEtOJNwly0vDg_XQS9f72f';
        const supabase = window.supabase.createClient(SB_URL, SB_KEY);

        function App() {
            const [systems, setSystems] = useState([]);
            const [activeSys, setActiveSys] = useState(null);
            const [notes, setNotes] = useState("");

            useEffect(() => { loadData(); }, []);

            const loadData = async () => {
                const { data } = await supabase.from('systems').select('*').order('id');
                setSystems(data || []);
            };

            const handleSave = async () => {
                await supabase.from('systems').update({ notes }).eq('id', activeSys.id);
                setActiveSys(null);
                loadData();
            };

            return (
                <div className="min-h-screen p-4 md:p-8">
                    <header className="flex justify-between items-center mb-8 bg-white p-6 rounded-2xl shadow-sm">
                        <h1 className="text-2xl font-bold text-slate-800">QA Dashboard</h1>
                        <button 
                            onClick={() => {
                                const id = prompt("New System ID:");
                                if(id) supabase.from('systems').insert([{id}]).then(loadData);
                            }}
                            className="bg-blue-600 text-white px-4 py-2 rounded-xl font-bold"
                        >
                            + Add System
                        </button>
                    </header>

                    <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                        {systems.map(s => (
                            <div 
                                key={s.id}
                                onClick={() => { setActiveSys(s); setNotes(s.notes || ""); }}
                                className="bg-white p-6 rounded-2xl border border-slate-200 hover:border-blue-500 cursor-pointer transition-all shadow-sm"
                            >
                                <div className="flex justify-between items-center mb-2">
                                    <span className="text-2xl font-black">#{s.id}</span>
                                    <div className={`h-3 w-3 rounded-full ${s.notes ? 'bg-green-500' : 'bg-slate-200'}`} />
                                </div>
                                <p className="text-slate-500 text-sm truncate">{s.notes || "No data"}</p>
                            </div>
                        ))}
                    </div>

                    {activeSys && (
                        <div className="fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50">
                            <div className="bg-white w-full max-w-lg rounded-3xl p-8 shadow-2xl">
                                <h2 className="text-3xl font-bold mb-6 text-slate-800">System #{activeSys.id}</h2>
                                <textarea 
                                    className="w-full h-40 border border-slate-200 rounded-2xl p-4 mb-6 focus:ring-2 focus:ring-blue-500 outline-none"
                                    value={notes}
                                    onChange={(e) => setNotes(e.target.value)}
                                />
                                <div className="flex gap-4">
                                    <button onClick={handleSave} className="flex-1 bg-blue-600 text-white py-4 rounded-xl font-bold">Save Update</button>
                                    <button onClick={() => setActiveSys(null)} className="flex-1 bg-slate-100 text-slate-600 py-4 rounded-xl font-bold">Cancel</button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
